# Синхронизация Web → Flutter

Этот документ описывает только шаг синхронизации. Он выполняется ПОСЛЕ внесения изменений в web.

## Предусловия

- изменения в `src/web` завершены;
- если добавлялась версия или приложение, `src/web/registry.ts` уже обновлен;
- в web‑интерфейсе виден путь: приложение → версия → экран.

## Порядок действий

1. Определи точный путь web‑версии.
   - пример: `src/web/system/Launcher/v2`
2. Создай или выбери нужную версию Flutter‑проекта.
   - если это новая итерация — создай новую версию: `apps/system/Launcher/v2`;
   - не редактируй старые версии.
3. Перенеси структуру и компоновку экранов.
   - каждый web‑экран должен иметь соответствующий Flutter‑экран;
   - сохраняй иерархию блоков, отступов, размеров и align‑правил.
4. Перенеси стили и токены.
   - создавай/обновляй `theme/tokens.dart` и `theme/typography.dart` внутри версии;
   - цвета, размеры, радиусы, тени, spacing должны совпадать с web.
5. Перенеси компоненты.
   - создавай виджеты в `widgets/` внутри конкретного Flutter‑проекта;
   - не используй общий каталог компонентов между приложениями.
6. Сверь состояния и варианты.
   - нормальное/нажатое/disabled состояния;
   - варианты размеров и layout‑режимы;
   - empty/loading/error состояния при необходимости.
7. Проведи визуальную сверку.
   - сравни экран в web и Flutter на одинаковом разрешении;
   - исправь расхождения в typography, spacing, alignment и цветах.
8. Убедись, что Flutter‑проект полностью обособлен.
9. Автоматически подготовь платформы запуска.
   - не проси пользователя делать это вручную;
   - если в целевом Flutter‑проекте нет нужных платформ, выполни в корне версии:
     - `flutter create --platforms=macos,web .`
   - не меняй логику в `lib/` при генерации платформ.
10. Автоматически выполни техпроверку проекта.
   - в корне версии выполни:
     - `flutter pub get`
     - `dart format lib`
     - `flutter analyze`
11. В ответе пользователю укажи готовую команду запуска.
   - минимум:
     - `flutter run -d chrome`
   - если доступен desktop:
     - `flutter run -d macos`

## Автоматический режим по триггеру

Если запрос пользователя буквально или по смыслу равен:
- "Синхронизируй Web и Flutter"

то выполняй весь порядок выше целиком, включая шаги 9-11, без дополнительных просьб к пользователю запускать промежуточные команды.

## Что запрещено

- импортировать код из других Flutter‑проектов;
- редактировать старые версии вместо создания новых;
- оставлять несоответствия в визуале между web и Flutter.

## Мини‑чеклист перед завершением

- Все затронутые web‑экраны перенесены в Flutter.
- Токены и типографика синхронизированы.
- Компоненты размещены локально в `widgets/`.
- Визуал совпадает с web.
- Flutter‑платформы (macos/web) подготовлены автоматически при необходимости.
- Выполнены `flutter pub get`, `dart format lib`, `flutter analyze`.
